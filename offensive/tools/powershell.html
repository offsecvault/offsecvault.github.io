<!DOCTYPE html>
<html lang="en-US">

<head>
  <title>offsecvault - Knowledge Base</title>
  <!--------------------->
  <!-- b0ydC owned. -->
  <!-- --------------- -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8" />

  <style>
    body {
      font-size: 12px;
      font-family: ubuntu mono;
      background-color: white;
      color: black;
      margin: 0;
    }

    a {
      color: black;
      font-weight: bold;
      text-decoration: none;
    }

    a:hover,
    a:active {
      color: #868686;
      text-decoration: underline;
    }
    table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
    }

    table.center {
    margin-left: auto; 
    margin-right: auto;
}
    
  </style>
</head>

<body>
  <pre><center>
<a href="/index.html" style="text-decoration:none;">
 ▒█████    █████▒ █████▒ ██████ ▓█████  ▄████▄ ██▒   █▓ ▄▄▄       █    ██  ██▓  ▄▄▄█████▓
▒██▒  ██▒▓██   ▒▓██   ▒▒██    ▒ ▓█   ▀ ▒██▀ ▀█▓██░   █▒▒████▄     ██  ▓██▒▓██▒  ▓  ██▒ ▓▒
▒██░  ██▒▒████ ░▒████ ░░ ▓██▄   ▒███   ▒▓█    ▄▓██  █▒░▒██  ▀█▄  ▓██  ▒██░▒██░  ▒ ▓██░ ▒░
▒██   ██░░▓█▒  ░░▓█▒  ░  ▒   ██▒▒▓█  ▄ ▒▓▓▄ ▄██▒▒██ █░░░██▄▄▄▄██ ▓▓█  ░██░▒██░  ░ ▓██▓ ░ 
░ ████▓▒░░▒█░   ░▒█░   ▒██████▒▒░▒████▒▒ ▓███▀ ░ ▒▀█░   ▓█   ▓██▒▒▒█████▓ ░██████▒▒██▒ ░ 
░ ▒░▒░▒░  ▒ ░    ▒ ░   ▒ ▒▓▒ ▒ ░░░ ▒░ ░░ ░▒ ▒  ░ ░ ▐░   ▒▒   ▓▒█░░▒▓▒ ▒ ▒ ░ ▒░▓  ░▒ ░░   
  ░ ▒ ▒░  ░      ░     ░ ░▒  ░ ░ ░ ░  ░  ░  ▒    ░ ░░    ▒   ▒▒ ░░░▒░ ░ ░ ░ ░ ▒  ░  ░    
░ ░ ░ ▒   ░ ░    ░ ░   ░  ░  ░     ░   ░           ░░    ░   ▒    ░░░ ░ ░   ░ ░   ░      
    ░ ░                      ░     ░  ░░ ░          ░        ░  ░   ░         ░  ░       
                                       ░           ░                                     
</a></pre>

<div style="font-size:24px; text-align:center; font-family:courier,monospace;">
    <a href="../../RED-TEAM.html">OFFENSIVE</a> |
    <a href="../../BLUE-TEAM.html">DEFENSIVE</a> |
    <a href="../../CTF.html">CTF</a> |
    <a href="../../TOOLS.html">TOOLS</a> |
    <a href="../../ABOUT.html">ABOUT</a> 
</div>
<pre style="text-align:center;">
<h3> Powershell Usage </h3>

::: get help all (it will retrieve all help options)

PS> Get-Help * 

::: get help by keyword (it will retrieve all content associated to the keyword)

PS> Get-Help [keyword]
PS> Get-Help process

::: update help system

PS> Update-Help

::: get help by item (it will retrieve all information associated to a specific item, sample: cmdlet)

PS> Get-Help Get-Item [itemname] -Full

::: get samples about an item (it will retrieve different samples about the usage of the item)

PS> Get-Help Get-Item [itemname] -Examples

::: list all available cmdlets

PS> Get-Command -CommandType [cmdlet]

::: bypass the execution policy

PS> powershell -ExecutionPolicy bypass
PS> powershell -c [cmd]
PS> powershell -encodedcommand 
$env:PS ExecutionPolicy Preference="bypass"

::: import a module

PS> Import-Module <modulePath>

::: list commands in a module

PS> Get-Command -Module <moduleName>

::: load powershell script using dot sourcing

PS> . [fullpath]
PS> . C:\b0ydC\Tools\PowerView.ps1

::: bypass powershell security controls

<a href="https://github.com/OmerYa/Invisi-Shell">invisi-shell | bypass security controls</a> 
** required the .dll file and the execution file needed [admin/non-admin]
RunWithPathAsAdmin.bat
RunWithRegistryNonAdmin.bat

::: bypass AV signatures 

- load script in memory to avoid AMSI bypass
AMSI Trigger to identify the part of the script that is detected !! Repeat the process until it is not detected to avoid detection on execution phase.
<a href="https://github.com/RythmStick/AMSITrigger">AMSITrigger</a> 
quick usage:

PS> AmsiTrigger.exe -i [filePath]

flags:

-i = input file
-u, --url=VALUE
-f, --format=VALUE          

Output Format:
1 - Only show Triggers
2 - Show Triggers with Line numbers
3 - Show Triggers inline with code
4 - Show AMSI calls (xmas tree mode)

::: full obfuscation
<a href="https://github.com/danielbohannon/Invoke-Obfuscation">Invoke-Obfuscation</a> 

::: get language mode on current session 
PS> $ExecutionContext.SessionState.LanguageMode
FullLanguage | means you can do whatever the privs allow it

::: TYPE: domain enumeration
<a href="/offensive/powershell_domain_enumeration.html"> Domain Enumeration</a> 

</center>
</body>
</html>
