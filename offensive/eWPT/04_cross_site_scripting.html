<!DOCTYPE html>
<html lang="en-US">

<head>
  <title>offsecvault - Knowledge Base</title>
  <!--------------------->
  <!-- b0ydC owned. -->
  <!-- --------------- -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8" />

   <style>
    body {
      font-size: 12px;
      font-family: ubuntu mono;
      background-color: white;
      color: black;
      margin: 0;
    }

    a {
      color: black;
      font-weight: bold;
      text-decoration: none;
    }
	
	* {
      box-sizing: border-box;
    }

	details {
      border: 2px solid black;
      border-radius: 2px;
      font-size: 10px;
      padding: .5em .5em 0;
    }

    summary {
      font-weight: bold;
      margin: -.5em -.5em 0;
      padding: .5em;
    }

    details[open] summary {
      background: black;
      color: white;
    }

    details[open] {
      background: white;
      color: black;
      padding: .5em .5em 0;
    }

    a:hover,
    a:active {
      color: #b81212;
      text-decoration: underline;
    }
	
    table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
    }

    table.center {
    margin-left: auto; 
    margin-right: auto;
}
</style>
</head>

<body>
  <pre><center>
<a href="/index.html" style="text-decoration:none;">
 ▒█████    █████▒ █████▒ ██████ ▓█████  ▄████▄ ██▒   █▓ ▄▄▄       █    ██  ██▓  ▄▄▄█████▓
▒██▒  ██▒▓██   ▒▓██   ▒▒██    ▒ ▓█   ▀ ▒██▀ ▀█▓██░   █▒▒████▄     ██  ▓██▒▓██▒  ▓  ██▒ ▓▒
▒██░  ██▒▒████ ░▒████ ░░ ▓██▄   ▒███   ▒▓█    ▄▓██  █▒░▒██  ▀█▄  ▓██  ▒██░▒██░  ▒ ▓██░ ▒░
▒██   ██░░▓█▒  ░░▓█▒  ░  ▒   ██▒▒▓█  ▄ ▒▓▓▄ ▄██▒▒██ █░░░██▄▄▄▄██ ▓▓█  ░██░▒██░  ░ ▓██▓ ░ 
░ ████▓▒░░▒█░   ░▒█░   ▒██████▒▒░▒████▒▒ ▓███▀ ░ ▒▀█░   ▓█   ▓██▒▒▒█████▓ ░██████▒▒██▒ ░ 
░ ▒░▒░▒░  ▒ ░    ▒ ░   ▒ ▒▓▒ ▒ ░░░ ▒░ ░░ ░▒ ▒  ░ ░ ▐░   ▒▒   ▓▒█░░▒▓▒ ▒ ▒ ░ ▒░▓  ░▒ ░░   
  ░ ▒ ▒░  ░      ░     ░ ░▒  ░ ░ ░ ░  ░  ░  ▒    ░ ░░    ▒   ▒▒ ░░░▒░ ░ ░ ░ ░ ▒  ░  ░    
░ ░ ░ ▒   ░ ░    ░ ░   ░  ░  ░     ░   ░           ░░    ░   ▒    ░░░ ░ ░   ░ ░   ░      
    ░ ░                      ░     ░  ░░ ░          ░        ░  ░   ░         ░  ░       
                                       ░           ░                                     
</a></pre>

<div style="font-size:24px; text-align:center; font-family:courier,monospace;">
    <a href="../../RED-TEAM.html">OFFENSIVE</a> |
    <a href="../../BLUE-TEAM.html">DEFENSIVE</a> |
    <a href="../../CTF.html">CTF</a> |
    <a href="../../TOOLS.html">TOOLS</a> |
    <a href="../../ABOUT.html">ABOUT</a> 
</div>
<pre style="text-align:center;">
<h3> 04.cross site scripting  </h3>

>>> portswigger: 

https://portswigger.net/web-security/cross-site-scripting

classic XSS test

-> <script>alert('This is an XSS');</script>

XSS possible attacks

-cookie stealing
-complete control over a browser
-initiating an explotation phase against browser plugins and then the machine
-perform keylogging 

******

when stealing a cookie, the goal is to find the vulnerability associated to the domain assigned to the
cookie founded. 
-when a vuln is founded, it is time to create a link or image with the specific payload to send it to the user 
so the user can click on this and exploit the vulnerability. 

>> 3 types of XSS

-reflected: occurs when untrusted user data is sent to web app and it is inmediately echoed back as the untrusted content.
... PROCESS
.victims bring the payload in their HTTP request to the vulnerable site, the payload will be inserted into the web page 
and executed in the browser. 

-> victim click the link >> request sent to the server >> response back to the client with the payload info >> execution on client side.

-stored or persistent: similar to reflected XSS, however, it does not reflect into the response, it is stored within the application.

are attacks that lead to the execution of code in all the user's web browsers visiting a vulnerable (and exploited) site.

-DOM XSS: simply put, it only exist on client side code. lives in the DOM environment, it does nor reach the server side code. 
the goal is that the client side script code can access the browsers DOM thus all the information available in it. 

::: FINDING XSS

.1 find all correlations between input > output, so if what the user is reflected any where on the site.
.2 try to inject js or html code into the previous defined targets [GET/POST - HTTP HEADERS - COOKIE VARIABLES]

NOTE: one way to test is to add the HTML parameter <plaintext> to the input, so if the XSS attack is present you will see
a page under construction. it does not mean you can execute script, however the XSS possibility is present. 
all tags after the plaintext is inserted will be threated as plaintext. 

potential objectives:
-cookie stealing

sample: 

.offsecvault.com | it will be open to any subdomain of offsecvault.com, Eg. foo.offsecvault.com , red.offsecvault.com and more.
the * is used like a wildcard. 

.www.sadgo.com | again it will be applied for all subdomains of www.sadgo.com. 

NOTE: when a cookie is issued with the parameter path=/ it is valid for all the directories of the domains it
applies. path can limit the attack surface to an only subdirectory Eg. path=/cars/, so it is limited to "cars" folder or subfolders.
without the final slash Eg. path=/cars will be like a wildcard for this cars folder, /carswash | /carsdm | cars* & more.

httponly flag prevents javascript to read the content of the cookie file. (however exist a workaround)

"secure cookies" - these cookies are sent only if https (SSL) is used in the request

-defacement
-phishing/malware
-XSS worms


</center>
</body>
</html>
