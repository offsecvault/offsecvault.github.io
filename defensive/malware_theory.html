<!DOCTYPE html>
<html lang="en-US">

<head>
  <title>offsecvault - Knowledge Base</title>
  <!--------------------->
  <!-- b0ydC owned. -->
  <!-- --------------- -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8" />

  <style>
    body {
      font-size: 12px;
      font-family: ubuntu mono;
      background-color: white;
      color: black;
      margin: 0;
    }

    a {
      color: black;
      font-weight: bold;
      text-decoration: none;
    }

    a:hover,
    a:active {
      color: #868686;
      text-decoration: underline;
    }
    table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
    }

    table.center {
    margin-left: auto; 
    margin-right: auto;
}
    
  </style>
</head>

<body>
  <pre><center>
<a href="/index.html" style="text-decoration:none;">
 ▒█████    █████▒ █████▒ ██████ ▓█████  ▄████▄ ██▒   █▓ ▄▄▄       █    ██  ██▓  ▄▄▄█████▓
▒██▒  ██▒▓██   ▒▓██   ▒▒██    ▒ ▓█   ▀ ▒██▀ ▀█▓██░   █▒▒████▄     ██  ▓██▒▓██▒  ▓  ██▒ ▓▒
▒██░  ██▒▒████ ░▒████ ░░ ▓██▄   ▒███   ▒▓█    ▄▓██  █▒░▒██  ▀█▄  ▓██  ▒██░▒██░  ▒ ▓██░ ▒░
▒██   ██░░▓█▒  ░░▓█▒  ░  ▒   ██▒▒▓█  ▄ ▒▓▓▄ ▄██▒▒██ █░░░██▄▄▄▄██ ▓▓█  ░██░▒██░  ░ ▓██▓ ░ 
░ ████▓▒░░▒█░   ░▒█░   ▒██████▒▒░▒████▒▒ ▓███▀ ░ ▒▀█░   ▓█   ▓██▒▒▒█████▓ ░██████▒▒██▒ ░ 
░ ▒░▒░▒░  ▒ ░    ▒ ░   ▒ ▒▓▒ ▒ ░░░ ▒░ ░░ ░▒ ▒  ░ ░ ▐░   ▒▒   ▓▒█░░▒▓▒ ▒ ▒ ░ ▒░▓  ░▒ ░░   
  ░ ▒ ▒░  ░      ░     ░ ░▒  ░ ░ ░ ░  ░  ░  ▒    ░ ░░    ▒   ▒▒ ░░░▒░ ░ ░ ░ ░ ▒  ░  ░    
░ ░ ░ ▒   ░ ░    ░ ░   ░  ░  ░     ░   ░           ░░    ░   ▒    ░░░ ░ ░   ░ ░   ░      
    ░ ░                      ░     ░  ░░ ░          ░        ░  ░   ░         ░  ░       
                                       ░           ░                                     
</a></pre>

<div style="font-size:24px; text-align:center; font-family:courier,monospace;">
    <a href="RED-TEAM.html">OFFENSIVE</a> |
    <a href="BLUE-TEAM.html">DEFENSIVE</a> |
    <a href="CTF.html">CTF</a> |
    <a href="TOOLS.html">TOOLS</a> |
    <a href="ABOUT.html">ABOUT</a> 
</div>
<pre style="text-align:center;">

<h3>//HASHING//</h3>

hash = signature

- hashing collision: refers when two different files generate the same hash.

- common malware hashing functions: 

'''''''''''''''''''''''''''''''
' MD5     | 128 bits | 32 Hex '
' SHA1    | 160 bits | 40 Hex '
' SHA256  | 256 bits | 64 Hex '
'''''''''''''''''''''''''''''''

- fuzzy hashing: used to compare hash files to check for similitudes. 

<h3>//STRINGS//</h3>

- last character in a sequence of characters or index is called "escape sequence" which means the end of the string. 
terminators: x0 or NUL | 00

--> ASCII
  7 bits, which means 128 characters. represented nowadays by 1-byte (8 bits)
  
    - printable: every character
    - non-printable: the ones we normally do not see, ex: enter or spaces
    LineFeed, LF | "\n" or CarriageReturn, CR | "\r"
   
--> UNICODE
  represented by 2 bytes, UTF-16

valid info gathered running strings:

  > functions invoked
  > internal or external messages
  > sections used
  > IP addresses or domain names associated
  > error handling 
  
<h3>//PE FILE FORMAT//</h3>

PE "portable executable" derived from COFF "common object file format"

.dll | .exe | .acm | .ax | .cpl | .drv | .efi | .mui | .ocx | .scr | .sys | .tsp

linker = helps to add libraries to the final executables

- static linking = resolve requirements and embbed the library to the final .exe
- dynamic linking
    - implicit = it reference the library into the executable, however are loaded once it is executed. (not embbeded) 
    - explicit = it not require to be linked, it is done by the developer on the code itself, nothing to load.
  
<h3>PE file structure</h3>
 
''''''''''''''''''''
' MS-DOS Header    '
' File Header      '
' Optional Header  '
' Section Header   '
'__________________'
'     Sections     '
' .text            '
' .data            '
' .idata           '
' .rsrc            '
' .reloc           '
''''''''''''''''''''
MS-DOS header = start with signature: "MZ" or e_lfanew: "0x5A4D".
 
COFF file header / machine types

desc | constant | value       
x64  | IMAGE_FILE_MACHINE_AMD64 | 0x8664          
inter 386 or later | IMAGE_FILE_MACHINE_I386 | 0x14c 
ARM little endian | IMAGE_FILE_MACHINE_ARM | 0x1c0
ARM64 little endian | IMAGE_FILE_MACHINE_ARM64 | 0xaa64
Power PC little endian | IMAGE_FILE_MACHINE_POWERPC | 0x1f0
 
characteristics flags

> file
IMAGE_FILE_EXECUTABLE_IMAGE    | for image only, file valid can be run
IMAGE_FILE_LARGE_ADDRESS_AWARE | app can handle >2-GB addresses
IMAGE_FILE_32BIT_MACHINE       | 32 bit arch
IMAGE_FILE_SYSTEM              | system file, not user program
IMAGE_FILE_DLL                 | dynamic link library

> dll
IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE      | dll could be realocated at load time
IMAGE_DLLCHARACTERISTICS_FORCE_INTEGRITY   | code integrity checks are enforced


pag 170....

</pre>
</center>
</body>
</html>
